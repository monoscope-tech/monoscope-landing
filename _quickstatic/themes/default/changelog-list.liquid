{% render "default/components/head", this:this, config:config %}
{% render "default/components/nav", this:this, config:config %}

<main>
  <section class="max-w-4xl px-3 mx-auto">
    <div class="mt-8 sm:mt-32 pb-20">
      <div class="mb-12 space-y-6">
        <h1 class="text-3xl font-normal leading-tight text-textStrong">
          Changelog
        </h1>
        <p class="text-lg text-textWeak">
          Stay up to date with the latest features, fixes, and improvements.
        </p>
      </div>

      <div class="relative">
        <div class="absolute left-0 md:left-6 top-0 bottom-0 w-px bg-strokeWeak"></div>

        {% assign changelog_entries = file_list | where_glob: 'file_path', "./changelog/*/index.md" | sort: "frontmatter.date" | reverse %}

        {% for entry in changelog_entries %}
          <article class="relative pl-8 md:pl-16 pb-12 last:pb-0">
            <div class="absolute left-0 md:left-6 -translate-x-1/2 w-3 h-3 rounded-full bg-fillBrand-strong border-4 border-bgBase"></div>

            <a href="{{ entry.permalink }}" class="block group">
              <time class="text-sm font-medium text-textDisabled" datetime="{{ entry.frontmatter.date }}">
                {{ entry.frontmatter.date | date: "%B %d, %Y" }}
              </time>
              <h2 class="text-xl font-normal text-textStrong mt-1 group-hover:text-textBrand transition-colors">
                {{ entry.frontmatter.title }}
              </h2>
            </a>

            {% if entry.frontmatter.categories %}
              <div class="flex flex-wrap gap-2 mt-3">
                {% for category in entry.frontmatter.categories %}
                  {% case category %}
                    {% when 'feature' %}
                      {% assign badge_class = "bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400" %}
                    {% when 'fix' %}
                      {% assign badge_class = "bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400" %}
                    {% when 'improvement' %}
                      {% assign badge_class = "bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400" %}
                    {% when 'performance' %}
                      {% assign badge_class = "bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400" %}
                    {% when 'security' %}
                      {% assign badge_class = "bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400" %}
                    {% when 'breaking' %}
                      {% assign badge_class = "bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400" %}
                    {% when 'deprecated' %}
                      {% assign badge_class = "bg-gray-100 text-gray-800 dark:bg-gray-700/30 dark:text-gray-400" %}
                    {% else %}
                      {% assign badge_class = "bg-gray-100 text-gray-800 dark:bg-gray-700/30 dark:text-gray-400" %}
                  {% endcase %}
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium {{ badge_class }}">
                    {{ category | capitalize }}
                  </span>
                {% endfor %}
              </div>
            {% endif %}

            {% if entry.frontmatter.summary %}
              <p class="mt-3 text-textWeak">{{ entry.frontmatter.summary }}</p>
            {% endif %}

            <a href="{{ entry.permalink }}" class="mt-3 inline-block text-sm font-medium text-textBrand hover:underline hover:underline-offset-2">
              View details &rarr;
            </a>
          </article>
        {% endfor %}

        {% if changelog_entries.size == 0 %}
          <div class="pl-8 md:pl-16 text-textWeak">
            <p>No changelog entries yet. Check back soon!</p>
          </div>
        {% endif %}
      </div>

      <div class="pt-16">
        <div class="border-t border-strokeWeak"></div>
      </div>
    </div>
  </section>
</main>

{% render "default/components/foot", this:this %}
